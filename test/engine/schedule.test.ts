// deno-fmt-ignore-file
import { Buffer } from '../../src/device.ts'
import { DType, PtrDType } from '../../src/dtype.ts'
import { LazyBuffer } from '../../src/engine/lazy.ts'
import { _append_st_vars, apply_swizzle, create_schedule_with_vars, full_ast_rewrite, init_big_graph, push_swizzle_down_through_elementwise, realize_view, ScheduleContext, ScheduleItemContext, to_uop } from '../../src/engine/schedule.ts'
import { counter, Metadata } from '../../src/helpers.ts'
import { Ops, UOp } from '../../src/ops.ts'
import { ShapeTracker } from '../../src/shape/shapetracker.ts'
import { View } from '../../src/shape/view.ts'
import { compare } from '../helpers.ts'

Deno.test(
  'schedule.to_uop',
  compare(
    [
        [new LazyBuffer(`CLANG`, new ShapeTracker([new View([1], [0], 0, undefined, true)]), new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), Ops.COPY, 8, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([1], [0], 0, undefined, true)]), new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([8], [1], 107744, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], undefined, new Metadata(`to`, ``, false)), new ScheduleContext(new Map([]), new Map([]), new Set([]), new Map([]), new Map([]), new Map([]), new Map([])), new Map<UOp,Buffer>([]), new Map<LazyBuffer,UOp>([])],
        [new LazyBuffer(`CLANG`, new ShapeTracker([new View([1], [0], 0, undefined, true)]), new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), Ops.COPY, 8, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([1], [0], 0, undefined, true)]), new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([8], [1], 330216, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], undefined, new Metadata(`to`, ``, false)), new ScheduleContext(new Map([]), new Map([]), new Set([]), new Map([]), new Map([]), new Map([]), new Map([])), new Map<UOp,Buffer>([]), new Map<LazyBuffer,UOp>([])],
        [new LazyBuffer(`CLANG`, new ShapeTracker([new View([10], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.COPY, 40, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([10], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([40], [1], 353776, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], undefined, new Metadata(`to`, ``, false)), new ScheduleContext(new Map([]), new Map([]), new Set([]), new Map([]), new Map([]), new Map([]), new Map([])), new Map<UOp,Buffer>([]), new Map<LazyBuffer,UOp>([])],
        [new LazyBuffer(`CLANG`, new ShapeTracker([new View([32], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.COPY, 128, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([32], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([128], [1], 4832, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], undefined, new Metadata(`to`, ``, false)), new ScheduleContext(new Map([]), new Map([]), new Set([]), new Map([]), new Map([]), new Map([]), new Map([])), new Map<UOp,Buffer>([]), new Map<LazyBuffer,UOp>([])],
        [new LazyBuffer(`CLANG`, new ShapeTracker([new View([32], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.COPY, 128, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([32], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([128], [1], 107488, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], undefined, new Metadata(`to`, ``, false)), new ScheduleContext(new Map([]), new Map([]), new Set([]), new Map([]), new Map([]), new Map([]), new Map([])), new Map<UOp,Buffer>([]), new Map<LazyBuffer,UOp>([])],
        [new LazyBuffer(`CLANG`, new ShapeTracker([new View([32], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.COPY, 128, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([32], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([128], [1], 107616, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], undefined, new Metadata(`to`, ``, false)), new ScheduleContext(new Map([]), new Map([]), new Set([]), new Map([]), new Map([]), new Map([]), new Map([])), new Map<UOp,Buffer>([]), new Map<LazyBuffer,UOp>([])]
    ],
    (buf: LazyBuffer, ctx: ScheduleContext, buffers: Map<UOp, Buffer>, cache: Map<LazyBuffer, UOp>)=>{
        UOp.buffer_num = counter(0) //resetting counter
        return to_uop(buf,ctx,buffers,cache)
    },
    'out(tiny.engine.schedule.to_uop(*data))',
  ),
)

Deno.test(
  'apply_swizzle',
  compare(
    [
        [new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([10], [1], 0, undefined, true)]) }), new ShapeTracker([new View([1, 10], [0, 1], 0, undefined, true)])],
        [new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([10], [1], 0, undefined, true)]) }), new ShapeTracker([new View([10, 1], [1, 0], 0, undefined, true)])],
        [new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([256], [1], 0, undefined, true)]) }), new ShapeTracker([new View([256, 1], [1, 0], 0, undefined, true)])],
        [new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([60000], [1], 0, undefined, true)]) }), new ShapeTracker([new View([60000, 1], [1, 0], 0, undefined, true)])],
        [new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([64], [1], 0, undefined, true)]) }), new ShapeTracker([new View([1, 64, 1, 1], [0, 1, 0, 0], 0, undefined, true)])],
        [new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([512, 1], [1, 0], 0, undefined, true)]) }), new ShapeTracker([new View([512, 1, 1], [1, 0, 0], 0, undefined, true)])]
    ],
    apply_swizzle,
    'out(tiny.engine.schedule.apply_swizzle(*data))',
  ),
)

Deno.test(
  'push_swizzle_down_through_elementwise',
  compare(
    [
        [new UOp({ op:Ops.WHERE, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VALID, dtype:new DType({ priority:0, itemsize:1, name:`bool`, fmt:`?`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([10], [0], 0, undefined, false)]) })], arg:undefined }), new UOp({ op:Ops.CONST, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[], arg:-1 }), new UOp({ op:Ops.CONST, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[], arg:0 })], arg:undefined })],
        [new UOp({ op:Ops.WHERE, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VALID, dtype:new DType({ priority:0, itemsize:1, name:`bool`, fmt:`?`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([512], [0], 0, undefined, false)]) })], arg:undefined }), new UOp({ op:Ops.CONST, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[], arg:0 }), new UOp({ op:Ops.CONST, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[], arg:0 })], arg:undefined })],
        [new UOp({ op:Ops.WHERE, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VALID, dtype:new DType({ priority:0, itemsize:1, name:`bool`, fmt:`?`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) })], arg:undefined }), new UOp({ op:Ops.CONST, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[], arg:1 }), new UOp({ op:Ops.CONST, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[], arg:0 })], arg:undefined })],
        [new UOp({ op:Ops.WHERE, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VALID, dtype:new DType({ priority:0, itemsize:1, name:`bool`, fmt:`?`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([60000], [0], 0, undefined, false)]) })], arg:undefined }), new UOp({ op:Ops.CONST, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[], arg:-1 }), new UOp({ op:Ops.CONST, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[], arg:0 })], arg:undefined })],
        [new UOp({ op:Ops.WHERE, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VALID, dtype:new DType({ priority:0, itemsize:1, name:`bool`, fmt:`?`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([512], [0], 0, undefined, false)]) })], arg:undefined }), new UOp({ op:Ops.CONST, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[], arg:60000 }), new UOp({ op:Ops.CONST, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[], arg:0 })], arg:undefined })],
        [new UOp({ op:Ops.WHERE, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VALID, dtype:new DType({ priority:0, itemsize:1, name:`bool`, fmt:`?`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([10, 1], [0, 0], 0, undefined, false)]) })], arg:undefined }), new UOp({ op:Ops.CONST, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[], arg:-1 }), new UOp({ op:Ops.CONST, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[], arg:0 })], arg:undefined })]
    ],
    push_swizzle_down_through_elementwise,
    'out(tiny.engine.schedule.push_swizzle_down_through_elementwise(*data))',
  ),
)

Deno.test(
  '_append_st_vars',
  compare(
    [
        [new ScheduleItemContext(new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[25, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([1], [0], 0, undefined, true)]), new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([8], [1], 107744, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], [new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[24, [`CLANG`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new LazyBuffer(`CLANG`, new ShapeTracker([new View([1], [0], 0, undefined, true)]), new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), Ops.COPY, 8, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([1], [0], 0, undefined, true)]), new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([8], [1], 107744, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], undefined, new Metadata(`to`, ``, false))]]), new Map([[new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[26, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:undefined })], arg:new ShapeTracker([new View([8], [1], 107744, undefined, false)]) })], arg:undefined }), new Metadata(`bitcast`, ``, false)], [new UOp({ op:Ops.COPY, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[25, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) })], arg:undefined })], arg:8 }), new Metadata(`to`, ``, false)]]), new Set([]), new Map([]), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[24, [`CLANG`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.COPY, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[25, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) })], arg:undefined })], arg:8 })]]), new Set([]), [], new Set([new Metadata(`to`, ``, false)]), new Map([])), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) })],
        [new ScheduleItemContext(new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[52, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([1], [0], 0, undefined, true)]), new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([8], [1], 330216, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], [new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[51, [`CLANG`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new LazyBuffer(`CLANG`, new ShapeTracker([new View([1], [0], 0, undefined, true)]), new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), Ops.COPY, 8, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([1], [0], 0, undefined, true)]), new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([8], [1], 330216, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], undefined, new Metadata(`to`, ``, false))]]), new Map([[new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[53, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:undefined })], arg:new ShapeTracker([new View([8], [1], 330216, undefined, false)]) })], arg:undefined }), new Metadata(`bitcast`, ``, false)], [new UOp({ op:Ops.COPY, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[52, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) })], arg:undefined })], arg:8 }), new Metadata(`to`, ``, false)]]), new Set([]), new Map([]), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[51, [`CLANG`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.COPY, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[52, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) })], arg:undefined })], arg:8 })]]), new Set([]), [], new Set([new Metadata(`to`, ``, false)]), new Map([])), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) })],
        [new ScheduleItemContext(new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[10, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([32], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([128], [1], 4832, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], [new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[9, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new LazyBuffer(`CLANG`, new ShapeTracker([new View([32], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.COPY, 128, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([32], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([128], [1], 4832, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], undefined, new Metadata(`to`, ``, false))]]), new Map([[new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[11, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:undefined })], arg:new ShapeTracker([new View([128], [1], 4832, undefined, false)]) })], arg:undefined }), new Metadata(`bitcast`, ``, false)], [new UOp({ op:Ops.COPY, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[10, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })], arg:undefined })], arg:128 }), new Metadata(`to`, ``, false)]]), new Set([]), new Map([]), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[9, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.COPY, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[10, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })], arg:undefined })], arg:128 })]]), new Set([]), [], new Set([new Metadata(`to`, ``, false)]), new Map([])), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })],
        [new ScheduleItemContext(new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[64, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 10, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([10], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([40], [1], 353776, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], [new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[63, [`CLANG`, 10, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new LazyBuffer(`CLANG`, new ShapeTracker([new View([10], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.COPY, 40, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([10], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([40], [1], 353776, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], undefined, new Metadata(`to`, ``, false))]]), new Map([[new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[65, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:undefined })], arg:new ShapeTracker([new View([40], [1], 353776, undefined, false)]) })], arg:undefined }), new Metadata(`bitcast`, ``, false)], [new UOp({ op:Ops.COPY, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[64, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 10, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([10], [1], 0, undefined, true)]) })], arg:undefined })], arg:40 }), new Metadata(`to`, ``, false)]]), new Set([]), new Map([]), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[63, [`CLANG`, 10, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.COPY, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[64, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 10, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([10], [1], 0, undefined, true)]) })], arg:undefined })], arg:40 })]]), new Set([]), [], new Set([new Metadata(`to`, ``, false)]), new Map([])), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([10], [1], 0, undefined, true)]) })],
        [new ScheduleItemContext(new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[28, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([32], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([128], [1], 107752, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], [new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[27, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new LazyBuffer(`CLANG`, new ShapeTracker([new View([32], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.COPY, 128, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([32], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([128], [1], 107752, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], undefined, new Metadata(`to`, ``, false))]]), new Map([[new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[29, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:undefined })], arg:new ShapeTracker([new View([128], [1], 107752, undefined, false)]) })], arg:undefined }), new Metadata(`bitcast`, ``, false)], [new UOp({ op:Ops.COPY, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[28, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })], arg:undefined })], arg:128 }), new Metadata(`to`, ``, false)]]), new Set([]), new Map([]), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[27, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.COPY, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[28, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })], arg:undefined })], arg:128 })]]), new Set([]), [], new Set([new Metadata(`to`, ``, false)]), new Map([])), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })],
        [new ScheduleItemContext(new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[19, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([32], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([128], [1], 107488, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], [new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[18, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new LazyBuffer(`CLANG`, new ShapeTracker([new View([32], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.COPY, 128, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([32], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([128], [1], 107488, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], undefined, new Metadata(`to`, ``, false))]]), new Map([[new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[20, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:undefined })], arg:new ShapeTracker([new View([128], [1], 107488, undefined, false)]) })], arg:undefined }), new Metadata(`bitcast`, ``, false)], [new UOp({ op:Ops.COPY, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[19, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })], arg:undefined })], arg:128 }), new Metadata(`to`, ``, false)]]), new Set([]), new Map([]), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[18, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.COPY, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[19, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })], arg:undefined })], arg:128 })]]), new Set([]), [], new Set([new Metadata(`to`, ``, false)]), new Map([])), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })]
    ],
    _append_st_vars,
    'out(tiny.engine.schedule._append_st_vars(*data))',
  ),
)

Deno.test(
  'full_ast_rewrite',
  compare(
    [
        [new UOp({ op:Ops.SINK, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.STORE, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[24, [`CLANG`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) }), new UOp({ op:Ops.COPY, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[25, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) })], arg:undefined })], arg:8 })], arg:undefined })], arg:undefined }), new ScheduleContext(new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[25, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([1], [0], 0, undefined, true)]), new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([8], [1], 107744, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], [new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[24, [`CLANG`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new LazyBuffer(`CLANG`, new ShapeTracker([new View([1], [0], 0, undefined, true)]), new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), Ops.COPY, 8, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([1], [0], 0, undefined, true)]), new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([8], [1], 107744, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], undefined, new Metadata(`to`, ``, false))]]), new Map([]), new Set([]), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[24, [`CLANG`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.STORE, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[24, [`CLANG`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) }), new UOp({ op:Ops.COPY, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[25, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) })], arg:undefined })], arg:8 })], arg:undefined })], [new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[25, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.STORE, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[25, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) }), new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[26, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:undefined })], arg:new ShapeTracker([new View([8], [1], 107744, undefined, false)]) })], arg:undefined })], arg:undefined })]]), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[25, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[25, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[26, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] })], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:new ShapeTracker([new View([8], [1], 107744, undefined, false)]) })], arg:undefined })], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) })], [new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[24, [`CLANG`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[24, [`CLANG`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.COPY, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[25, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[26, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] })], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:new ShapeTracker([new View([8], [1], 107744, undefined, false)]) })], arg:undefined })], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) })], arg:8 })], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) })]]), new Map([[new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[26, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:undefined })], arg:new ShapeTracker([new View([8], [1], 107744, undefined, false)]) })], arg:undefined }), new Metadata(`bitcast`, ``, false)], [new UOp({ op:Ops.COPY, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[25, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) })], arg:undefined })], arg:8 }), new Metadata(`to`, ``, false)]]), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[25, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[24, [`CLANG`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), undefined]])]]))],
        [new UOp({ op:Ops.SINK, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.STORE, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[51, [`CLANG`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) }), new UOp({ op:Ops.COPY, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[52, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) })], arg:undefined })], arg:8 })], arg:undefined })], arg:undefined }), new ScheduleContext(new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[52, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([1], [0], 0, undefined, true)]), new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([8], [1], 330216, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], [new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[51, [`CLANG`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new LazyBuffer(`CLANG`, new ShapeTracker([new View([1], [0], 0, undefined, true)]), new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), Ops.COPY, 8, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([1], [0], 0, undefined, true)]), new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([8], [1], 330216, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], undefined, new Metadata(`to`, ``, false))]]), new Map([]), new Set([]), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[51, [`CLANG`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.STORE, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[51, [`CLANG`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) }), new UOp({ op:Ops.COPY, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[52, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) })], arg:undefined })], arg:8 })], arg:undefined })], [new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[52, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.STORE, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[52, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) }), new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[53, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:undefined })], arg:new ShapeTracker([new View([8], [1], 330216, undefined, false)]) })], arg:undefined })], arg:undefined })]]), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[52, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[52, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[53, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] })], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:new ShapeTracker([new View([8], [1], 330216, undefined, false)]) })], arg:undefined })], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) })], [new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[51, [`CLANG`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[51, [`CLANG`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.COPY, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[52, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[53, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] })], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:new ShapeTracker([new View([8], [1], 330216, undefined, false)]) })], arg:undefined })], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) })], arg:8 })], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) })]]), new Map([[new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[53, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:undefined })], arg:new ShapeTracker([new View([8], [1], 330216, undefined, false)]) })], arg:undefined }), new Metadata(`bitcast`, ``, false)], [new UOp({ op:Ops.COPY, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[52, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([1], [0], 0, undefined, true)]) })], arg:undefined })], arg:8 }), new Metadata(`to`, ``, false)]]), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[52, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined, _base:new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[51, [`CLANG`, 1, new DType({ priority:7, itemsize:8, name:`long`, fmt:`q`, count:1, _scalar:undefined })]] }), undefined]])]]))],
        [new UOp({ op:Ops.SINK, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.STORE, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[9, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) }), new UOp({ op:Ops.COPY, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[10, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })], arg:undefined })], arg:128 })], arg:undefined })], arg:undefined }), new ScheduleContext(new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[10, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([32], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([128], [1], 4832, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], [new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[9, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new LazyBuffer(`CLANG`, new ShapeTracker([new View([32], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.COPY, 128, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([32], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([128], [1], 4832, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], undefined, new Metadata(`to`, ``, false))]]), new Map([]), new Set([]), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[9, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.STORE, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[9, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) }), new UOp({ op:Ops.COPY, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[10, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })], arg:undefined })], arg:128 })], arg:undefined })], [new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[10, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.STORE, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[10, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) }), new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[11, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:undefined })], arg:new ShapeTracker([new View([128], [1], 4832, undefined, false)]) })], arg:undefined })], arg:undefined })]]), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[10, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[10, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[11, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] })], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:new ShapeTracker([new View([128], [1], 4832, undefined, false)]) })], arg:undefined })], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })], [new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[9, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[9, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.COPY, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[10, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[11, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] })], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:new ShapeTracker([new View([128], [1], 4832, undefined, false)]) })], arg:undefined })], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })], arg:128 })], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })]]), new Map([[new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[11, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:undefined })], arg:new ShapeTracker([new View([128], [1], 4832, undefined, false)]) })], arg:undefined }), new Metadata(`bitcast`, ``, false)], [new UOp({ op:Ops.COPY, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[10, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })], arg:undefined })], arg:128 }), new Metadata(`to`, ``, false)]]), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[10, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[9, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), undefined]])]]))],
        [new UOp({ op:Ops.SINK, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.STORE, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[63, [`CLANG`, 10, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([10], [1], 0, undefined, true)]) }), new UOp({ op:Ops.COPY, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[64, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 10, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([10], [1], 0, undefined, true)]) })], arg:undefined })], arg:40 })], arg:undefined })], arg:undefined }), new ScheduleContext(new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[64, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 10, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([10], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([40], [1], 353776, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], [new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[63, [`CLANG`, 10, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new LazyBuffer(`CLANG`, new ShapeTracker([new View([10], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.COPY, 40, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([10], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([40], [1], 353776, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], undefined, new Metadata(`to`, ``, false))]]), new Map([]), new Set([]), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[63, [`CLANG`, 10, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.STORE, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[63, [`CLANG`, 10, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([10], [1], 0, undefined, true)]) }), new UOp({ op:Ops.COPY, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[64, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 10, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([10], [1], 0, undefined, true)]) })], arg:undefined })], arg:40 })], arg:undefined })], [new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[64, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 10, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.STORE, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[64, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 10, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([10], [1], 0, undefined, true)]) }), new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[65, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:undefined })], arg:new ShapeTracker([new View([40], [1], 353776, undefined, false)]) })], arg:undefined })], arg:undefined })]]), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[64, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 10, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[64, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 10, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[65, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] })], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:new ShapeTracker([new View([40], [1], 353776, undefined, false)]) })], arg:undefined })], arg:new ShapeTracker([new View([10], [1], 0, undefined, true)]) })], [new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[63, [`CLANG`, 10, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[63, [`CLANG`, 10, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.COPY, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[64, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 10, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[65, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] })], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:new ShapeTracker([new View([40], [1], 353776, undefined, false)]) })], arg:undefined })], arg:new ShapeTracker([new View([10], [1], 0, undefined, true)]) })], arg:40 })], arg:new ShapeTracker([new View([10], [1], 0, undefined, true)]) })]]), new Map([[new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[65, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:undefined })], arg:new ShapeTracker([new View([40], [1], 353776, undefined, false)]) })], arg:undefined }), new Metadata(`bitcast`, ``, false)], [new UOp({ op:Ops.COPY, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[64, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 10, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([10], [1], 0, undefined, true)]) })], arg:undefined })], arg:40 }), new Metadata(`to`, ``, false)]]), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[64, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 10, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[63, [`CLANG`, 10, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), undefined]])]]))],
        [new UOp({ op:Ops.SINK, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.STORE, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[15, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) }), new UOp({ op:Ops.COPY, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[16, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })], arg:undefined })], arg:128 })], arg:undefined })], arg:undefined }), new ScheduleContext(new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[16, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([32], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([128], [1], 107360, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], [new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[15, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new LazyBuffer(`CLANG`, new ShapeTracker([new View([32], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.COPY, 128, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([32], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([128], [1], 107360, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], undefined, new Metadata(`to`, ``, false))]]), new Map([]), new Set([]), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[15, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.STORE, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[15, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) }), new UOp({ op:Ops.COPY, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[16, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })], arg:undefined })], arg:128 })], arg:undefined })], [new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[16, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.STORE, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[16, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) }), new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[17, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:undefined })], arg:new ShapeTracker([new View([128], [1], 107360, undefined, false)]) })], arg:undefined })], arg:undefined })]]), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[16, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[16, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[17, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] })], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:new ShapeTracker([new View([128], [1], 107360, undefined, false)]) })], arg:undefined })], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })], [new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[15, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[15, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.COPY, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[16, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[17, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] })], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:new ShapeTracker([new View([128], [1], 107360, undefined, false)]) })], arg:undefined })], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })], arg:128 })], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })]]), new Map([[new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[17, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:undefined })], arg:new ShapeTracker([new View([128], [1], 107360, undefined, false)]) })], arg:undefined }), new Metadata(`bitcast`, ``, false)], [new UOp({ op:Ops.COPY, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[16, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })], arg:undefined })], arg:128 }), new Metadata(`to`, ``, false)]]), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[16, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[15, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), undefined]])]]))],
        [new UOp({ op:Ops.SINK, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.STORE, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[21, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) }), new UOp({ op:Ops.COPY, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[22, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })], arg:undefined })], arg:128 })], arg:undefined })], arg:undefined }), new ScheduleContext(new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[22, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([32], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([128], [1], 107616, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], [new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[21, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new LazyBuffer(`CLANG`, new ShapeTracker([new View([32], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.COPY, 128, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([32], [1], 0, undefined, true)]), new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), Ops.BUFFER_VIEW, undefined, [new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([128], [1], 107616, undefined, false)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), undefined, undefined, [], new LazyBuffer(`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, new ShapeTracker([new View([353816], [1], 0, undefined, true)]), new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), Ops.EMPTY, undefined, [], undefined, undefined), new Metadata(`__getitem__`, ``, false))], undefined, new Metadata(`bitcast`, ``, false))], undefined, new Metadata(`to`, ``, false))]]), new Map([]), new Set([]), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[21, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.STORE, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[21, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) }), new UOp({ op:Ops.COPY, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[22, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })], arg:undefined })], arg:128 })], arg:undefined })], [new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[22, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.STORE, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[22, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) }), new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[23, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:undefined })], arg:new ShapeTracker([new View([128], [1], 107616, undefined, false)]) })], arg:undefined })], arg:undefined })]]), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[22, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[22, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[23, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] })], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:new ShapeTracker([new View([128], [1], 107616, undefined, false)]) })], arg:undefined })], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })], [new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[21, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[21, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.COPY, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[22, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[23, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] })], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:new ShapeTracker([new View([128], [1], 107616, undefined, false)]) })], arg:undefined })], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })], arg:128 })], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })]]), new Map([[new UOp({ op:Ops.BUFFER_VIEW, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.VIEW, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined, _base:new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[23, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 353816, new DType({ priority:2, itemsize:1, name:`unsigned char`, fmt:`B`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([353816], [1], 0, undefined, true)]) })], arg:undefined })], arg:new ShapeTracker([new View([128], [1], 107616, undefined, false)]) })], arg:undefined }), new Metadata(`bitcast`, ``, false)], [new UOp({ op:Ops.COPY, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.LOAD, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[22, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:Ops.VIEW, dtype:new DType({ priority:-1, itemsize:0, name:`void`, fmt:undefined, count:1, _scalar:undefined }), src:[], arg:new ShapeTracker([new View([32], [1], 0, undefined, true)]) })], arg:undefined })], arg:128 }), new Metadata(`to`, ``, false)]]), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[22, [`DISK:/Users/karel/Documents/denograd/tinygrad/model.safetensors`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new Map([[new UOp({ op:Ops.BUFFER, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[21, [`CLANG`, 32, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), undefined]])]]))]
    ],
    full_ast_rewrite,
    'out(tiny.engine.schedule.full_ast_rewrite(*data))',
  ),
)

Deno.test(
  'uval',
  compare(
    [],
    () => {},
    'out(XXX)',
  ),
)

Deno.test(
  'recursive_group',
  compare(
    [],
    () => {},
    'out(XXX)',
  ),
)

Deno.test(
  'get_isolated_children',
  compare(
    [],
    () => {},
    'out(XXX)',
  ),
)

Deno.test(
  'group_realizes',
  compare(
    [],
    () => {},
    'out(XXX)',
  ),
)

Deno.test(
  '_as_const',
  compare(
    [],
    () => {},
    'out(XXX)',
  ),
)

Deno.test(
  'realize_view',
  compare(
    [
    //   [new Map(),new UOp({ op:13, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[new UOp({ op:15, dtype:new PtrDType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined, _base:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[83, [`CLANG`, 1, new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined })]] }), new UOp({ op:62, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[], arg:0 })], arg:new ShapeTracker([new View([],[],0)]) }), new UOp({ op:13, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[new UOp({ op:13, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[new UOp({ op:15, dtype:new PtrDType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined, _base:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[83, [`CLANG`, 1, new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined })]] }), new UOp({ op:62, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[], arg:0 })], arg:new ShapeTracker([new View([],[],0)]) })], arg:new ShapeTracker([new View([512],[0],0)]) }), new UOp({ op:62, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[], arg:0 }), new UOp({ op:15, dtype:new PtrDType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined, _base:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[83, [`CLANG`, 1, new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined })]] })],
    //   [new Map(),new UOp({ op:13, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[new UOp({ op:15, dtype:new PtrDType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined, _base:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[88, [`CLANG`, 1, new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined })]] }), new UOp({ op:62, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[], arg:-1 })], arg:new ShapeTracker([new View([],[],0)]) }), new UOp({ op:13, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[new UOp({ op:13, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[new UOp({ op:15, dtype:new PtrDType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined, _base:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[88, [`CLANG`, 1, new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined })]] }), new UOp({ op:62, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[], arg:-1 })], arg:new ShapeTracker([new View([],[],0)]) })], arg:new ShapeTracker([new View([60000],[0],0)]) }), new UOp({ op:62, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[], arg:-1 }), new UOp({ op:15, dtype:new PtrDType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined, _base:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[88, [`CLANG`, 1, new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined })]] })],
    //   [new Map(),new UOp({ op:13, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[new UOp({ op:15, dtype:new PtrDType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined, _base:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[84, [`CLANG`, 1, new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined })]] }), new UOp({ op:62, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[], arg:60000 })], arg:new ShapeTracker([new View([],[],0)]) }), new UOp({ op:13, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[new UOp({ op:13, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[new UOp({ op:15, dtype:new PtrDType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined, _base:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[84, [`CLANG`, 1, new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined })]] }), new UOp({ op:62, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[], arg:60000 })], arg:new ShapeTracker([new View([],[],0)]) })], arg:new ShapeTracker([new View([512],[0],0)]) }), new UOp({ op:62, dtype:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), src:[], arg:60000 }), new UOp({ op:15, dtype:new PtrDType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined, _base:new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[84, [`CLANG`, 1, new DType({ priority:5, itemsize:4, name:`int`, fmt:`i`, count:1, _scalar:undefined })]] })],
    //   [new Map(),new UOp({ op:13, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:15, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[3, [`CLANG`, 1, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:62, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[], arg:0.9 })], arg:new ShapeTracker([new View([],[],0)]) }), new UOp({ op:13, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:13, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:15, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[3, [`CLANG`, 1, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:62, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[], arg:0.9 })], arg:new ShapeTracker([new View([],[],0)]) })], arg:new ShapeTracker([new View([1],[0],0)]) }), new UOp({ op:62, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[], arg:0.9 }), new UOp({ op:15, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[3, [`CLANG`, 1, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] })],
    //   [new Map(),new UOp({ op:13, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:15, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[2, [`CLANG`, 1, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:62, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[], arg:1.0 })], arg:new ShapeTracker([new View([],[],0)]) }), new UOp({ op:13, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:13, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:15, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[2, [`CLANG`, 1, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:62, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[], arg:1.0 })], arg:new ShapeTracker([new View([],[],0)]) })], arg:new ShapeTracker([new View([1],[0],0)]) }), new UOp({ op:62, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[], arg:1.0 }), new UOp({ op:15, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[2, [`CLANG`, 1, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] })],
    //   [new Map(),new UOp({ op:13, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:15, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[99, [`CLANG`, 1, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:62, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[], arg:0.4 })], arg:new ShapeTracker([new View([],[],0)]) }), new UOp({ op:13, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:13, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[new UOp({ op:15, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[99, [`CLANG`, 1, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] }), new UOp({ op:62, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[], arg:0.4 })], arg:new ShapeTracker([new View([],[],0)]) })], arg:new ShapeTracker([new View([32],[0],0)]) }), new UOp({ op:62, dtype:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), src:[], arg:0.4 }), new UOp({ op:15, dtype:new PtrDType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined, _base:new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined }), local:false, v:1 }), src:[], arg:[99, [`CLANG`, 1, new DType({ priority:11, itemsize:4, name:`float`, fmt:`f`, count:1, _scalar:undefined })]] })]
    ],
    realize_view,
    'out(tiny.engine.schedule.realize_view(*data))',
  ),
)

Deno.test(
  'init_big_graph',
  compare(
    [],
    init_big_graph,
    'out(XXX)',
  ),
)

Deno.test(
  'create_schedule_with_vars',
  compare(
    [
    ],
    create_schedule_with_vars,
    'out(XXX)',
  ),
)
